<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è 3D –û–±—Å–µ—Ä–≤–∞—Ç–æ—Ä–∏—è</title>
    <script src="https://unpkg.com/three@0.132.2/build/three.min.js"></script>
    <script src="https://unpkg.com/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <script src="https://unpkg.com/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        body {
            margin: 0;
            overflow: hidden;
            background-color: black;
            font-family: 'Orbitron', sans-serif;
        }

        canvas {
            display: block;
        }

        #info-panel {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 20, 50, 0.9);
            padding: 20px;
            border-radius: 15px;
            color: white;
            width: 30%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 0 20px rgba(0, 191, 255, 0.7);
            backdrop-filter: blur(10px);
            transition: opacity 0.5s;
        }

        #info-panel img {
            width: 150px;
            height: 120px;
            border-radius: 50%;
            margin-bottom: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        #info-panel h2 {
            margin: 0;
            font-size: 24px;
            color: #00ffcc;
        }

        #info-panel p {
            margin: 5px 0;
            font-size: 16px;
            color: #ffffff;
        }

        #focus-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(50, 50, 100, 0.9);
            padding: 15px;
            border-radius: 15px;
            color: white;
            display: flex;
            flex-direction: column;
            gap: 10px;
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.7);
            backdrop-filter: blur(10px);
        }

        button {
            background: linear-gradient(135deg, #ff007f, #7f00ff);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            font-family: 'Orbitron', sans-serif;
        }

        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300%;
            height: 300%;
            background: rgba(255, 255, 255, 0.2);
            transition: 0.5s;
            border-radius: 50%;
            transform: translate(-50%, -50%) scale(0);
        }

        button:hover::before {
            transform: translate(-50%, -50%) scale(1);
        }

        button:hover {
            box-shadow: 0 0 20px rgba(255, 0, 127, 0.8);
        }

        #exit-observe {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff0000, #ff7300);
            color: white;
            padding: 12px 20px;
            border-radius: 30px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
            text-transform: uppercase;
            font-family: 'Orbitron', sans-serif;
        }

        #exit-observe:hover {
            box-shadow: 0 0 20px rgba(255, 115, 0, 0.8);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤ (—à–∏—Ä–∏–Ω–∞ —ç–∫—Ä–∞–Ω–∞ –¥–æ 1024px) */
        @media (max-width: 1024px) {
            #info-panel {
                width: 50%;
                padding: 15px;
            }

            #info-panel img {
                width: 120px;
                height: 100px;
            }

            #info-panel h2 {
                font-size: 20px;
            }

            #info-panel p {
                font-size: 14px;
            }

            #focus-panel {
                top: 15px;
                right: 15px;
                padding: 10px;
            }

            button {
                padding: 10px 15px;
                font-size: 14px;
            }

            #exit-observe {
                padding: 10px 15px;
                font-size: 14px;
            }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (—à–∏—Ä–∏–Ω–∞ —ç–∫—Ä–∞–Ω–∞ –¥–æ 768px) */
        @media (max-width: 768px) {
            #info-panel {
                width: 95%;
                bottom: 10px;
                left: 50%;
                transform: translateX(-50%);
                padding: 10px;
            }

            #info-panel img {
                width: 100px;
                height: 80px;
            }

            #info-panel h2 {
                font-size: 18px;
            }

            #info-panel p {
                font-size: 12px;
            }

            #focus-panel {
                top: 10px;
                right: 10px;
                padding: 8px;
            }

            button {
                padding: 8px 12px;
                font-size: 12px;
            }

            #exit-observe {
                padding: 8px 12px;
                font-size: 12px;
            }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ (—à–∏—Ä–∏–Ω–∞ —ç–∫—Ä–∞–Ω–∞ –¥–æ 480px) */
        @media (max-width: 480px) {
            #info-panel {
                width: 100%;
                bottom: 5px;
                padding: 8px;
            }

            #info-panel img {
                width: 80px;
                height: 60px;
            }

            #info-panel h2 {
                font-size: 16px;
            }

            #info-panel p {
                font-size: 10px;
            }

            #focus-panel {
                top: 5px;
                right: 5px;
                padding: 5px;
            }

            button {
                padding: 6px 10px;
                font-size: 10px;
            }

            #exit-observe {
                padding: 6px 10px;
                font-size: 10px;
            }
        }
    </style>
</head>
<a href="{% url 'index' %}" class="button">üìö –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
<body>
    <button id="exit-observe" style="display: none;">–í—ã–π—Ç–∏ –∏–∑ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è</button>
    <div id="info-panel">
        <img id="info-image" src="" alt="–ü–ª–∞–Ω–µ—Ç–∞">
        <h2 id="info-name"></h2>
        <p id="info-description"></p>
        <p><strong>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –°–æ–ª–Ω—Ü–∞:</strong> <span id="info-distance"></span> –º–ª–Ω –∫–º</p>
        <p><strong>–î–∏–∞–º–µ—Ç—Ä:</strong> <span id="info-diameter"></span> –∫–º</p>
        <p><strong>–°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</strong> <span id="info-temperature"></span> ¬∞C</p>
    </div>

    <div id="focus-panel"></div>

    <script>
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 20000);
        camera.position.set(0, 300, 1000);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.outputEncoding = THREE.sRGBEncoding;
        document.body.appendChild(renderer.domElement);

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        camera.position.set(0, 250, 1200);
        controls.target.set(0, 0, 0);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.2;
        controls.minDistance = 200;
        controls.maxDistance = 5000;
        controls.maxPolarAngle = Math.PI / 2;

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
        scene.add(ambientLight);

        const sunLight = new THREE.PointLight(0xffffff, 2, 10000, 2);
        sunLight.position.set(0, 0, 0);
        sunLight.castShadow = true;
        sunLight.shadow.mapSize.width = 2048;
        sunLight.shadow.mapSize.height = 2048;
        scene.add(sunLight);

        const dirLight = new THREE.DirectionalLight(0xffffff, 0.5);
        dirLight.position.set(5, 10, 2);
        dirLight.castShadow = true;
        scene.add(dirLight);

        const planets = {};
        let focusedPlanet = null;

        const planetData = [
        {
            name: '–ú–µ—Ä–∫—É—Ä–∏–π',
            size: 5,
            distance: 80,
            orbitSpeed: 4.15,
            color: 0xaaaaaa,
            img: 'https://solarsystem.nasa.gov/system/feature_items/images/18_mercury_new.png',
            modelUrl: 'https://raw.githubusercontent.com/2ndVariety/3d-models/master/planets/mercury.glb',
            description: '–ë–ª–∏–∂–∞–π—à–∞—è –∫ –°–æ–ª–Ω—Ü—É –ø–ª–∞–Ω–µ—Ç–∞.',
            diameter: 4879,
            temperature: 167,
            gravity: 3.7,
            dayLength: 4222.6, // –í —á–∞—Å–∞—Ö
            moons: []
        },
        {
            name: '–í–µ–Ω–µ—Ä–∞',
            size: 10,
            distance: 120,
            orbitSpeed: 1.62,
            color: 0xffaa33,
            img: 'https://solarsystem.nasa.gov/system/feature_items/images/27_venus_jg.png',
            modelUrl: 'https://raw.githubusercontent.com/2ndVariety/3d-models/master/planets/venus.glb',
            description: '–í—Ç–æ—Ä–∞—è –ø–ª–∞–Ω–µ—Ç–∞ –æ—Ç –°–æ–ª–Ω—Ü–∞.',
            diameter: 12104,
            temperature: 464,
            gravity: 8.87,
            dayLength: 2802, // –í —á–∞—Å–∞—Ö
            moons: []
        },
        {
            name: '–ó–µ–º–ª—è',
            size: 12,
            distance: 160,
            orbitSpeed: 1,
            color: 0x3399ff,
            img: 'https://solarsystem.nasa.gov/system/feature_items/images/17_earth.png',
            modelUrl: 'https://raw.githubusercontent.com/2ndVariety/3d-models/master/planets/earth.glb',
            description: '–ù–∞—à –¥–æ–º.',
            diameter: 12742,
            temperature: 15,
            gravity: 9.81,
            dayLength: 24,
            moons: ['–õ—É–Ω–∞']
        },
        {
            name: '–ú–∞—Ä—Å',
            size: 8,
            distance: 220,
            orbitSpeed: 0.53,
            color: 0xff3300,
            img: 'https://solarsystem.nasa.gov/system/feature_items/images/19_mars.png',
            modelUrl: 'https://raw.githubusercontent.com/2ndVariety/3d-models/master/planets/mars.glb',
            description: '–ö—Ä–∞—Å–Ω–∞—è –ø–ª–∞–Ω–µ—Ç–∞.',
            diameter: 6779,
            temperature: -63,
            gravity: 3.71,
            dayLength: 24.6,
            moons: ['–§–æ–±–æ—Å', '–î–µ–π–º–æ—Å']
        },
        {
            name: '–Æ–ø–∏—Ç–µ—Ä',
            size: 30,
            distance: 320,
            orbitSpeed: 0.084,
            color: 0xff9933,
            img: 'https://solarsystem.nasa.gov/system/feature_items/images/16_jupiter_new.png',
            modelUrl: 'https://raw.githubusercontent.com/2ndVariety/3d-models/master/planets/jupiter.glb',
            description: '–ö—Ä—É–ø–Ω–µ–π—à–∞—è –ø–ª–∞–Ω–µ—Ç–∞.',
            diameter: 139820,
            temperature: -145,
            gravity: 24.79,
            dayLength: 9.9,
            moons: ['–ò–æ', '–ï–≤—Ä–æ–ø–∞', '–ì–∞–Ω–∏–º–µ–¥', '–ö–∞–ª–ª–∏—Å—Ç–æ', '–∏ –µ—â–µ 75']
        },
        {
            name: '–°–∞—Ç—É—Ä–Ω',
            size: 28,
            distance: 420,
            orbitSpeed: 0.034,
            color: 0xffcc99,
            img: 'https://solarsystem.nasa.gov/system/feature_items/images/28_saturn.png',
            modelUrl: 'https://raw.githubusercontent.com/2ndVariety/3d-models/master/planets/saturn.glb',
            description: '–ü–ª–∞–Ω–µ—Ç–∞ —Å –∫–æ–ª—å—Ü–∞–º–∏.',
            diameter: 116460,
            temperature: -178,
            gravity: 10.44,
            dayLength: 10.7,
            moons: ['–¢–∏—Ç–∞–Ω', '–≠–Ω—Ü–µ–ª–∞–¥', '–ú–∏–º–∞—Å', '–¢–µ—Ñ–∏—è', '–î–∏–æ–Ω', '–†–µ—è', '–Ø–ø–µ—Ç', '–∏ –µ—â–µ 80'],
            hasRings: true
        },
        {
            name: '–£—Ä–∞–Ω',
            size: 20,
            distance: 520,
            orbitSpeed: 0.012,
            color: 0x99ccff,
            img: 'https://solarsystem.nasa.gov/system/feature_items/images/29_uranus.png',
            modelUrl: 'https://raw.githubusercontent.com/2ndVariety/3d-models/master/planets/uranus.glb',
            description: '–õ–µ–¥—è–Ω–æ–π –≥–∏–≥–∞–Ω—Ç.',
            diameter: 50724,
            temperature: -224,
            gravity: 8.69,
            dayLength: 17.2,
            moons: ['–ú–∏—Ä–∞–Ω–¥–∞', '–ê—Ä–∏—ç–ª—å', '–£–º–±—Ä–∏—ç–ª—å', '–¢–∏—Ç–∞–Ω–∏—è', '–û–±–µ—Ä–∞–Ω', '–¢–µ–º–ø–µ—Å—Ç', '–∏ –µ—â–µ 22'],
        },
        {
            name: '–ù–µ–ø—Ç—É–Ω',
            size: 18,
            distance: 620,
            orbitSpeed: 0.006,
            color: 0x3333ff,
            img: 'https://solarsystem.nasa.gov/system/feature_items/images/30_neptune.png',
            modelUrl: 'https://raw.githubusercontent.com/2ndVariety/3d-models/master/planets/neptune.glb',
            description: '–î–∞–ª—å–Ω—è—è –ø–ª–∞–Ω–µ—Ç–∞.',
            diameter: 49244,
            temperature: -218,
            gravity: 11.15,
            dayLength: 16.1,
            moons: ['–¢—Ä–∏—Ç–æ–Ω', '–ü—Ä–æ—Ç–µ–π', '–ù–µ—Ä–µ–∏–¥–∞', '–õ–∞—Ä–∏—Å–∞', '–¢–∞–ª–∞—Å—Å–∞', '–î–µ—Å–ø–∏–Ω–∞', '–∏ –µ—â–µ 12'],
        },
        {
            name: '–ü–ª—É—Ç–æ–Ω', // –ö–∞—Ä–ª–∏–∫–æ–≤–∞—è –ø–ª–∞–Ω–µ—Ç–∞
            size: 2,
            distance: 820,
            orbitSpeed: 0.004,
            color: 0x999999,
            img: 'https://solarsystem.nasa.gov/system/feature_items/images/40_pluto.png',
            modelUrl: 'https://raw.githubusercontent.com/2ndVariety/3d-models/master/planets/pluto.glb',
            description: '–ö–∞—Ä–ª–∏–∫–æ–≤–∞—è –ø–ª–∞–Ω–µ—Ç–∞, —Ä–∞–Ω–µ–µ —Å—á–∏—Ç–∞–≤—à–∞—è—Å—è –¥–µ–≤—è—Ç–æ–π.',
            diameter: 2376,
            temperature: -229,
            gravity: 0.62,
            dayLength: 153.3,
            moons: ['–•–∞—Ä–æ–Ω', '–ù–∏–∫—Å', '–ì–∏–¥—Ä–∞', '–ö–µ—Ä–±–µ—Ä–æ—Å', '–°—Ç–∏–∫—Å']
        }
    ];


        const sunMaterial = new THREE.MeshStandardMaterial({
            color: 0xffff00,
            emissive: 0xffff00,
            emissiveIntensity: 2
        });

        const sunGeometry = new THREE.SphereGeometry(50, 32, 32);
        const sun = new THREE.Mesh(sunGeometry, sunMaterial);
        scene.add(sun);

        planetData.forEach(data => {
            const geometry = new THREE.SphereGeometry(data.size, 32, 32);
            const material = new THREE.MeshStandardMaterial({ color: data.color });
            const planet = new THREE.Mesh(geometry, material);
            scene.add(planet);

            if (data.hasRings) {
                createRings(planet, data.size * 1.5, data.size * 2, 0xaaaaaa);
            }

            planets[data.name] = {
                mesh: planet,
                distance: data.distance,
                orbitSpeed: data.orbitSpeed,
                angle: Math.random() * Math.PI * 2,
                info: data
            };

            createFocusButton(data.name);
        });

        function createRings(planet, innerRadius, outerRadius, color) {
            const ringGeometry = new THREE.RingGeometry(innerRadius, outerRadius, 64);
            const ringMaterial = new THREE.MeshBasicMaterial({ color, side: THREE.DoubleSide });
            const ring = new THREE.Mesh(ringGeometry, ringMaterial);
            ring.rotation.x = Math.PI / 2;
            planet.add(ring);
        }

        function createFocusButton(name) {
            const button = document.createElement('button');
            button.innerText = name;
            button.onclick = () => focusOnPlanet(name);
            document.getElementById('focus-panel').appendChild(button);
        }

        function showInfo(name) {
            const info = planets[name].info;
            document.getElementById('info-image').src = info.img;
            document.getElementById('info-name').innerText = `üåç ${info.name}`;
            document.getElementById('info-description').innerText = `üìú ${info.description}`;
            document.getElementById('info-distance').innerText = `üìè –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: ${info.distance} –º–ª–Ω –∫–º`;
            document.getElementById('info-diameter').innerText = `‚ö™ –î–∏–∞–º–µ—Ç—Ä: ${info.diameter} –∫–º`;
            document.getElementById('info-temperature').innerText = `üå° –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: ${info.temperature}¬∞C`;
            document.getElementById('info-panel').style.display = 'flex';
        }

        function focusOnPlanet(name) {
            showInfo(name);
            focusedPlanet = planets[name];
        }

        function generateStars() {
            const starGeometry = new THREE.BufferGeometry();
            const starVertices = [];
            const starColors = [];

            for (let i = 0; i < 5000; i++) {
                const x = (Math.random() - 0.5) * 8000;
                const y = (Math.random() - 0.5) * 8000;
                const z = (Math.random() - 0.5) * 8000;
                starVertices.push(x, y, z);

                const colors = [0xffffff, 0xffd700, 0xadd8e6, 0xff4500];
                const color = new THREE.Color(colors[Math.floor(Math.random() * colors.length)]);
                starColors.push(color.r, color.g, color.b);
            }

            starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
            starGeometry.setAttribute('color', new THREE.Float32BufferAttribute(starColors, 3));

            const starMaterial = new THREE.PointsMaterial({ 
                vertexColors: true, 
                size: 1.5, 
                transparent: true, 
                opacity: 0.9 
            });

            const stars = new THREE.Points(starGeometry, starMaterial);
            scene.add(stars);

            function animateStars() {
                starMaterial.opacity = 0.8 + Math.sin(Date.now() * 0.001) * 0.2;
                requestAnimationFrame(animateStars);
            }
            animateStars();
        }

        generateStars();

        function animate() {
            requestAnimationFrame(animate);

            for (let name in planets) {
                let planet = planets[name];
                planet.angle += planet.orbitSpeed * 0.005;
                planet.mesh.position.x = Math.cos(planet.angle) * planet.distance;
                planet.mesh.position.z = Math.sin(planet.angle) * planet.distance;

                if (focusedPlanet === planet) {
                    const targetPosition = planet.mesh.position.clone().add(new THREE.Vector3(0, 50, 200));
                    camera.position.lerp(targetPosition, 0.05);
                    controls.target.lerp(planet.mesh.position, 0.05);
                    camera.lookAt(planet.mesh.position);
                }
            }

            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        const exitButton = document.getElementById('exit-observe');

        function exitObservationMode() {
            focusedPlanet = null;
            document.getElementById('info-panel').style.display = 'none';
            exitButton.style.display = 'none';
        }

        function handlePlanetClick(name) {
            if (focusedPlanet && focusedPlanet.info.name === name) {
                document.getElementById('info-panel').style.display = 'none';
                focusedPlanet = null;
                exitButton.style.display = 'none';
            } else {
                focusOnPlanet(name);
                exitButton.style.display = 'block';
            }
        }

        Object.keys(planets).forEach(name => {
            planets[name].mesh.userData = { planetName: name };
        });

        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();

        window.addEventListener('click', event => {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(Object.values(planets).map(p => p.mesh));

            if (intersects.length > 0) {
                const clickedPlanet = intersects[0].object.userData.planetName;
                handlePlanetClick(clickedPlanet);
            }
        });

        exitButton.addEventListener('click', exitObservationMode);
    </script>
</body>
</html>